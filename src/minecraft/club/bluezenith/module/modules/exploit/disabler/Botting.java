package club.bluezenith.module.modules.exploit.disabler;

import club.bluezenith.events.Listener;
import club.bluezenith.events.impl.SpawnPlayerEvent;
import club.bluezenith.events.impl.UpdatePlayerEvent;
import club.bluezenith.module.Module;
import club.bluezenith.module.value.types.ExtendedModeValue.Mode;
import club.bluezenith.util.MinecraftInstance;

public class Botting extends MinecraftInstance implements Mode {

    //spawn x coordinate
    private static final double SPAWN_X = 11.494374347271531;

    private int teleportBackTicks, suicideTicks;

    @Listener
    public void onPlayerUpdate(UpdatePlayerEvent event) {
        if(event.isPost()) return;

        if(teleportBackTicks > 0) {
            event.x = 0; //teleport to 0, 0, 0 to make the anticheat flag you and teleport to your actual death location.
            event.y = 0;
            event.z = 0;

            teleportBackTicks--;
        } else if(suicideTicks <= 0)
            suicideTicks = 5; //this one can be replaced with a boolean condition (it's not decremented) but i might find use for it later

        if(event.x != SPAWN_X) { //if the player isn't at spawn
            if(teleportBackTicks <= 0 && suicideTicks > 0) { //and has teleported back to the death location
                event.y -= 1000; //teleport into the void to instantly die
            }
        }
        /* jump (actually fly up since there's no ground check)
            because sometimes the anticheat won't lag you back to the death location
            unless you have some sort of movement */
        mc.thePlayer.jump();
    }

    @Listener
    public void onRespawn(SpawnPlayerEvent event) {
        teleportBackTicks = 5; //teleport back as soon as the player gets killed
    }

    @Override
    public void onEnable(Module module) {
        teleportBackTicks = 0;
        suicideTicks = 0;
    }
}
